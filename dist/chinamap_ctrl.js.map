{"version":3,"sources":["../src/chinamap_ctrl.js"],"names":["MetricsPanelCtrl","echarts","rendering","_","darkJson","chinaJson","chinaLocs","anhuiData","aomenData","beijingData","chongqingData","fujianData","gansuData","guangdongData","guangxiData","guizhouData","hainanData","hebeiData","heilongjiangData","henanData","hubeiData","hunanData","jiangsuData","jiangxiData","jilinData","liaoningData","neimengguData","ningxiaData","qinghaiData","shandongData","shanghaiData","shanxiData","shanxi1Data","sichuanData","taiwanData","tianjinData","xianggangData","xinjiangData","xizangData","yunnanData","zhejiangData","registerMap","registerTheme","panelDefaults","backgroundColor","itemNormalColor","itemBorderColor","itemEmphasisColor","labelColor","labelEmphasisColor","dataColors","thresholds","thresholdTextColor","unit","ChinaMapCtrl","$scope","$injector","$rootScope","backendSrv","get","then","prefs","area","currentProvince","rootScope","templateSrv","variableSrvT","defaults","panel","events","on","onDataReceived","bind","onInitEditMode","popData","type","that","demoData","forEach","item","pop","provinceId","key","substr","dstProvince","find","x","id","children","Array","dstCity","currLog","currLat","log","lat","parseFloat","push","name","city","parent","value","destProvince","province","length","provinceVal","Math","round","provinceData","popTypeList","map","minPopData","min","apply","maxPopData","max","provincePopTypeList","minProvinceData","maxProvinceData","dataList","iphone7","iphone8","iphonex","srcData","dataType","setData","render","addEditorTab","scope","elem","attrs","ctrl","templateUrl"],"mappings":"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","file":"chinamap_ctrl.js","sourcesContent":["import { MetricsPanelCtrl } from 'app/plugins/sdk';\nimport echarts from './lib/echarts.min';\nimport rendering from './rendering';\nimport _ from 'lodash';\n\nimport darkJson from './lib/map/dark';\nimport chinaJson from './lib/map/china';\nimport chinaLocs from './lib/map/china-city-loc';\n\nimport anhuiData from './lib/map/province/anhui';\necharts.registerMap('安徽', anhuiData);\nimport aomenData from './lib/map/province/aomen';\necharts.registerMap('澳门', aomenData);\nimport beijingData from './lib/map/province/beijing';\necharts.registerMap('北京', beijingData);\nimport chongqingData from './lib/map/province/chongqing';\necharts.registerMap('重庆', chongqingData);\nimport fujianData from './lib/map/province/fujian';\necharts.registerMap('福建', fujianData);\nimport gansuData from './lib/map/province/gansu';\necharts.registerMap('甘肃', gansuData);\nimport guangdongData from './lib/map/province/guangdong';\necharts.registerMap('广东', guangdongData);\nimport guangxiData from './lib/map/province/guangxi';\necharts.registerMap('广西', guangxiData);\nimport guizhouData from './lib/map/province/guizhou';\necharts.registerMap('贵州', guizhouData);\nimport hainanData from './lib/map/province/hainan';\necharts.registerMap('海南', hainanData);\nimport hebeiData from './lib/map/province/hebei';\necharts.registerMap('河北', hebeiData);\nimport heilongjiangData from './lib/map/province/heilongjiang';\necharts.registerMap('黑龙江', heilongjiangData);\nimport henanData from './lib/map/province/henan';\necharts.registerMap('河南', henanData);\nimport hubeiData from './lib/map/province/hubei';\necharts.registerMap('湖北', hubeiData);\nimport hunanData from './lib/map/province/hunan';\necharts.registerMap('湖南', hunanData);\nimport jiangsuData from './lib/map/province/jiangsu';\necharts.registerMap('江苏', jiangsuData);\nimport jiangxiData from './lib/map/province/jiangxi';\necharts.registerMap('江西', jiangxiData);\nimport jilinData from './lib/map/province/jilin';\necharts.registerMap('吉林', jilinData);\nimport liaoningData from './lib/map/province/liaoning';\necharts.registerMap('辽宁', liaoningData);\nimport neimengguData from './lib/map/province/neimenggu';\necharts.registerMap('内蒙古', neimengguData);\nimport ningxiaData from './lib/map/province/ningxia';\necharts.registerMap('宁夏', ningxiaData);\nimport qinghaiData from './lib/map/province/qinghai';\necharts.registerMap('青海', qinghaiData);\nimport shandongData from './lib/map/province/shandong';\necharts.registerMap('山东', shandongData);\nimport shanghaiData from './lib/map/province/shanghai';\necharts.registerMap('上海', shanghaiData);\nimport shanxiData from './lib/map/province/shanxi';\necharts.registerMap('山西', shanxiData);\nimport shanxi1Data from './lib/map/province/shanxi1';\necharts.registerMap('陕西', shanxi1Data);\nimport sichuanData from './lib/map/province/sichuan';\necharts.registerMap('四川', sichuanData);\nimport taiwanData from './lib/map/province/taiwan';\necharts.registerMap('台湾', taiwanData);\nimport tianjinData from './lib/map/province/tianjin';\necharts.registerMap('天津', tianjinData);\nimport xianggangData from './lib/map/province/xianggang';\necharts.registerMap('香港', xianggangData);\nimport xinjiangData from './lib/map/province/xinjiang';\necharts.registerMap('新疆', xinjiangData);\nimport xizangData from './lib/map/province/xizang';\necharts.registerMap('西藏', xizangData);\nimport yunnanData from './lib/map/province/yunnan';\necharts.registerMap('云南', yunnanData);\nimport zhejiangData from './lib/map/province/zhejiang';\necharts.registerMap('浙江', zhejiangData);\n\necharts.registerTheme('dark', darkJson);\necharts.registerMap('china', chinaJson);\n\nconst panelDefaults = {\n  backgroundColor: '#63696e',\n  itemNormalColor: '#2d3339',\n  itemBorderColor: '#404a59',\n  itemEmphasisColor: '#2a333d',\n  labelColor: '#f5f5f5',\n  labelEmphasisColor: '#f5896b',\n  dataColors: ['#83fa52','#f6630e','#f60e48'],\n  thresholds: '0,10',\n  thresholdTextColor: '#f5f5f5',\n  unit: 'ms'\n};\n\nexport class ChinaMapCtrl extends MetricsPanelCtrl {\n  constructor($scope, $injector, $rootScope, backendSrv) {\n    super($scope, $injector);\n    backendSrv.get(`/api/org/preferences`).then(prefs => {\n      if (prefs && prefs.area) {\n        this.currentProvince = prefs.area;\n      }\n\n      if (!this.currentProvince) {\n        this.currentProvince = 'china';\n      }\n\n      this.rootScope = $rootScope;\n      this.templateSrv = $injector.get('templateSrv');\n      this.variableSrvT = $injector.get('variableSrv');\n      _.defaults(this.panel, panelDefaults);\n      this.events.on('data-received', this.onDataReceived.bind(this));\n      this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n    });\n  }\n\n  setData(popData, type) {\n    let that = this;\n    let demoData = [\n      {'key': '北京', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '上海', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '天津', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '重庆', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '河北', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '山西', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '辽宁', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '吉林', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '黑龙江', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '浙江', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '福建', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '山东', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '河南', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '湖北', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '湖南', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '广东', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '海南', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '四川', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '贵州', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '云南', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '江西', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '陕西', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '青海', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '甘肃', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '广西', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '新疆', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '内蒙古', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '西藏', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '宁夏', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '台湾', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '香港', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '澳门', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '安徽', 'log': 0, 'lat': 0, 'children': []},\n      {'key': '江苏', 'log': 0, 'lat': 0, 'children': []}\n    ];\n\n    demoData.forEach(function (item) {\n      item[type] = 0;\n    });\n\n    popData.forEach(function (pop) {\n      let provinceId = pop.key.substr(0, 2) + '0000';\n      let dstProvince = chinaLocs.find(x => x.id === provinceId);\n\n      if (dstProvince) {\n        if (dstProvince.children instanceof Array) {\n          let dstCity = dstProvince.children.find(x => x.id === pop.key);\n\n          if (dstCity) {\n            let currLog = 0;\n            let currLat = 0;\n\n            if (pop.log) {\n              currLog = pop.log;\n              currLat = pop.lat;\n            } else {\n              currLog = parseFloat(dstCity.log);\n              currLat = parseFloat(dstCity.lat);\n            }\n\n            that.popData[type].push({\n              id: pop.id,\n              name: pop.name || dstCity.name,\n              city: dstCity.name,\n              parent: dstProvince.name,\n              value: [currLog, currLat, pop[type]]\n            });\n          }\n        } else {\n          // 直辖市\n          let currLog = 0;\n          let currLat = 0;\n\n          if (pop.log) {\n            currLog = pop.log;\n            currLat = pop.lat;\n          } else {\n            currLog = parseFloat(dstProvince.log);\n            currLat = parseFloat(dstProvince.lat);\n          }\n\n          that.popData[type].push({\n            id: pop.id,\n            name: pop.name || dstProvince.name,\n            city: dstProvince.name,\n            parent: dstProvince.name,\n            value: [currLog, currLat, pop[type]]\n          });\n        }\n\n        let destProvince = demoData.find(x => x.key === dstProvince.name);\n\n        if (destProvince) {\n          destProvince.log = dstProvince.log;\n          destProvince.lat = dstProvince.lat;\n          destProvince[type] += pop[type];\n          destProvince.children.push(pop);\n        }\n      }\n    });\n\n    demoData.forEach(function (province) {\n      if (province.children.length > 0) {\n        let provinceVal = Math.round(100 * province[type]) / 100;\n\n        that.provinceData[type].push({\n          name: province.key,\n          value: [parseFloat(province.log), parseFloat(province.lat), provinceVal]\n        });\n      }\n    });\n\n    let popTypeList = popData.map(x => x[type]);\n    this.minPopData[type] = Math.min.apply(null, popTypeList);\n    this.maxPopData[type] = Math.max.apply(null, popTypeList);\n\n    let provincePopTypeList = this.provinceData[type].map(x => x.value[2]);\n    this.minProvinceData[type] = Math.min.apply(null, provincePopTypeList);\n    this.maxProvinceData[type] = Math.max.apply(null, provincePopTypeList);\n  }\n\n  onDataReceived(dataList) {\n    this.provinceData = {iphone7: [], iphone8: [], iphonex: []};\n    this.popData = {iphone7: [], iphone8: [], iphonex: []};\n    this.minProvinceData = {iphone7: 0, iphone8: 0, iphonex: 0};\n    this.maxProvinceData = {iphone7: 0, iphone8: 0, iphonex: 0};\n    this.minPopData = {iphone7: 0, iphone8: 0, iphonex: 0};\n    this.maxPopData = {iphone7: 0, iphone8: 0, iphonex: 0};\n\n    let srcData = {\n      iphone7: [\n        {id: 0, key: '441400', iphone7: 20},\n        {id: 1, key: '441200', iphone7: 80},\n        {id: 2, key: '320800', iphone7: 90},\n        {id: 3, key: '320600', iphone7: 30},\n        {id: 4, key: '232700', iphone7: 20},\n        {id: 5, key: '231000', iphone7: 70},\n        {id: 6, name: '喀什001', key: '653100', 'log': 75.94, 'lat': 39.52, iphone7: 20},\n        {id: 7, name: '喀什002', key: '653100', 'log': 76.50, 'lat': 39, iphone7: 20},\n        {id: 8, key: '650200', iphone7: 60}\n      ],\n      iphone8: [\n        {id: 0, key: '441400', iphone8: 30},\n        {id: 1, key: '441200', iphone8: 10},\n        {id: 2, key: '320800', iphone8: 20},\n        {id: 3, key: '320600', iphone8: 80},\n        {id: 4, key: '232700', iphone8: 40},\n        {id: 5, key: '231000', iphone8: 20},\n        {id: 6, name: '喀什001', key: '653100', 'log': 75.94, 'lat': 39.52, iphone8: 80},\n        {id: 7, name: '喀什002', key: '653100', 'log': 76.50, 'lat': 39, iphone8: 70},\n        {id: 8, key: '650200', iphone8: 70}\n      ],\n      iphonex: [\n        {id: 0, key: '441400', iphonex: 50},\n        {id: 1, key: '441200', iphonex: 10},\n        {id: 2, key: '320800', iphonex: 20},\n        {id: 3, key: '320600', iphonex: 30},\n        {id: 4, key: '232700', iphonex: 80},\n        {id: 5, key: '231000', iphonex: 60},\n        {id: 6, name: '喀什001', key: '653100', 'log': 75.94, 'lat': 39.52, iphonex: 40},\n        {id: 7, name: '喀什002', key: '653100', 'log': 76.50, 'lat': 39, iphonex: 20},\n        {id: 8, key: '650200', iphonex: 90}\n      ]\n    };\n\n    for (let dataType in srcData) {\n      this.setData(srcData[dataType], dataType);\n    }\n\n    this.render();\n  }\n\n  onInitEditMode() {\n    this.addEditorTab('ChinaMap', 'public/plugins/grafana-chinamap-panel/editor.html', 2);\n  }\n\n  link(scope, elem, attrs, ctrl) {\n    rendering(scope, elem, attrs, ctrl);\n  }\n}\n\nChinaMapCtrl.templateUrl = 'module.html';\n"]}